{"version":3,"sources":["lib/jreact.js","lib/jreact-dom.js","index.js"],"names":["createElement","tag","attrs","children","Component","props","state","Object","assign","JreactDom","renderComponent","createDomFromVnode","vnode","document","createTextNode","Array","isArray","fragment","createDocumentFragment","forEach","vnodeChild","dom","appendChild","component","createComponent","$root","setAttribute","console","log","childVnode","_render","container","constructor","prototype","Jreact","render","parentNode","replaceChild","innerHTML","node","key","startsWith","toLocaleLowerCase","style","App","name","job","hobbies","saySomething","bind","Job","Hobby","map","v","JreactDOM","querySelector"],"mappings":"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","file":"chapter-2.e31bb0bc.map","sourceRoot":"..","sourcesContent":["/**\n * \n * @param {String} tag \n * @param {Object} attrs \n * @param  {String|Object} children \n */\nfunction createElement(tag, attrs, ...children) {\n  return {\n    tag, \n    attrs, \n    children\n  }\n}\n\nclass Component {\n  constructor(props = {}) {\n    this.state = {}\n    this.props = props\n  }\n\n  setState(state) {\n    Object.assign(this.state, state)\n    JreactDom.renderComponent(this)\n  }\n}\n\n\nexport default { createElement, Component }\n","import Jreact from './jreact'\n\n\n/**\n * \n * @param {VNode} vnode \n * @param {HTMLElement} container \n */\n\n /** step 1 */\n /*\nfunction _render(vnode, container) {\n  let node\n  if(typeof vnode === 'string') {\n    node = document.createTextNode(vnode)\n  }\n\n  if(typeof vnode === 'object') {\n    node = document.createElement(vnode.tag)\n    setAttribute(node, vnode.attrs)\n    vnode.children.forEach(childVnode => render(childVnode, node))\n  }\n\n  container.appendChild(node)\n}\n*/\n\n/** step 2 */\nfunction createDomFromVnode(vnode) {\n  if(!vnode) return\n  if(typeof vnode === 'string') {\n    return document.createTextNode(vnode)\n  }\n\n  /**step 3 */\n  if(Array.isArray(vnode)) {\n    let fragment = document.createDocumentFragment()\n    vnode.forEach(vnodeChild=> {\n      let dom = createDomFromVnode(vnodeChild)\n      fragment.appendChild(dom)\n    })\n    return fragment\n    \n  }\n  /** step3 end */\n\n  if(typeof vnode === 'object') {\n    if(typeof vnode.tag === 'function') {\n      //console.log(vnode)\n      let component = createComponent(vnode.tag, vnode.attrs)\n      renderComponent(component)\n      return component.$root\n    } else {\n      let dom = document.createElement(vnode.tag)\n      setAttribute(dom, vnode.attrs)\n      console.log(vnode)\n      vnode.children.forEach(childVnode => _render(childVnode, dom))\n      return dom\n    }\n  }\n}\n\nfunction _render(vnode, container) {\n  if(!vnode) return\n  let dom = createDomFromVnode(vnode)\n  return container.appendChild(dom)\n}\n\nfunction createComponent(constructor, attrs) {\n    //创建组件,设置组件属性\n    let component \n    \n    //如果是用class创建的\n    if(constructor.prototype instanceof Jreact.Component) {\n      component = new constructor(attrs)\n    } else {\n      component = new Jreact.Component(attrs)\n      component.constructor = constructor\n      component.render = function() {\n        return this.constructor(attrs)\n      }     \n    } \n    \n    return component\n}\n\nfunction renderComponent(component) {\n  let vnode = component.render()\n  console.log(vnode)\n  let dom = createDomFromVnode(vnode)\n\n  if(component.$root && component.$root.parentNode) {\n    component.$root.parentNode.replaceChild(dom, component.$root)\n  }\n  component.$root = dom\n}\n\n/** step 2  end*/\n\n/**\n * \n * @param {VNode} vnode \n * @param {HTMLElement} container \n */\nfunction render(vnode, container) {\n  container.innerHTML = ''\n  _render(vnode, container)  \n}\n\n/**\n * \n * @param {HTMLElement} node \n * @param {Object} attrs \n */\nfunction setAttribute(node, attrs) {\n  if(!attrs) return\n\n  for(let key in attrs) {\n    if(key.startsWith('on')) {\n      node[key.toLocaleLowerCase()] = attrs[key]\n    } else if(key === 'style') {\n      Object.assign(node.style, attrs[key])\n    } else {\n      node[key] = attrs[key]\n    }\n  }\n}\n\nexport default{\n  render,\n  setAttribute,\n  renderComponent\n}\n","import Jreact from './lib/jreact.js'\nimport JreactDOM from './lib/jreact-dom'\n\n\n/** step 1 */\n/**\n * 直接渲染JSX\n */\n/*\nJreactDom.render((\n  <h1>hello jirengu</h1>\n), document.querySelector('#app'))\n*/\n\n/** step 2 */ \n/**\n * 引入组件的概念\n */\n// class Component {\n//   constructor(props = {}) {\n//     this.state = {}\n//     this.props = props\n//   }\n\n//   setState(state) {\n//     Object.assign(this.state, state)\n//     JreactDOM.renderComponent(this)\n//   }\n// }\n\nclass App extends Jreact.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      name: '饥人谷',\n      job: '教大家写一个React',\n      hobbies: ['电影', '游戏']\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <h1>我是 { this.state.name }</h1>\n        <Job job = { this.state.job }></Job>\n        <Hobby hobbies = { this.state.hobbies } ></Hobby>\n        <button onClick = { this.saySomething.bind(this) }>点我</button>\n      </div>\n    )\n  }\n\n  saySomething () {\n    console.log('我的名字是' + this.state.name)\n  }\n}\n\nclass Job extends Jreact.Component {\n    render() {\n      return (\n        <p>我的职业是 { this.props.job }</p>\n      )\n    }\n}\n\nfunction Hobby(props) {\n  return (\n    <div>我的兴趣是\n      <ul>\n      { props.hobbies.map(v => <li>{ v }</li>) }\n      </ul>\n    </div>\n  )\n}\n\nJreactDOM.render(<App/>, document.querySelector('#app'))\n"]}